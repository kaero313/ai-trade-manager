{% extends "base.html" %}
{% block content %}
<section class="ops-shell">
  <div class="ops-top">
    <div class="ops-tags">
      <span class="chip chip-live">LIVE</span>
      <span class="chip">UPBIT KRW SPOT</span>
      <span class="chip" id="strategyChip">EMA 12/26 + RSI 14</span>
    </div>
    <div class="ops-meta">
      <span id="scheduleLabel">KST 24H</span>
      <span id="lastSyncLabel">Last Sync -</span>
    </div>
  </div>

  <section class="metrics-grid">
    <article class="metric-card">
      <div class="metric-label">Total Asset</div>
      <div class="metric-value mono" id="totalAssetValue">KRW -</div>
      <div class="metric-foot">
        <span class="metric-delta" id="totalAssetDelta">-</span>
        <span class="metric-sub">Holdings</span>
      </div>
    </article>
    <article class="metric-card">
      <div class="metric-label">Daily PnL</div>
      <div class="metric-value mono" id="dailyPnlValue">KRW -</div>
      <div class="metric-foot">
        <span class="metric-delta" id="dailyPnlWins">0 Wins</span>
        <span class="metric-sub" id="dailyPnlLosses">0 Loss</span>
      </div>
    </article>
    <article class="metric-card">
      <div class="metric-label">Capital Usage</div>
      <div class="metric-value mono" id="capitalUsageValue">0.0%</div>
      <div class="metric-foot">
        <span class="metric-delta" id="capitalUsageLimit">Limit 0.0%</span>
        <span class="metric-sub" id="capitalUsageState">-</span>
      </div>
    </article>
    <article class="metric-card">
      <div class="metric-label">Bot State</div>
      <div class="metric-value" id="botStateValue">Stopped</div>
      <div class="metric-foot">
        <span class="metric-delta" id="botHeartbeatValue">Heartbeat -</span>
        <button class="btn btn-compact" id="botActionBtn">Run</button>
      </div>
    </article>
  </section>

  <section class="panel-grid">
    <article class="panel monitor-panel">
      <div class="panel-head">
        <div class="panel-title">Symbol Pulse</div>
        <div class="panel-meta" id="pulseMeta">Top 5</div>
      </div>
      <ul class="pulse-list" id="pulseList">
        <li>
          <span class="mono">-</span>
          <div class="pulse-track"><span style="width: 0%;"></span></div>
          <span class="pulse-change">-</span>
        </li>
      </ul>
    </article>

    <article class="panel monitor-panel">
      <div class="panel-head">
        <div class="panel-title">Order Throughput</div>
        <div class="panel-meta">12H</div>
      </div>
      <div class="spark-box">
        <div class="spark-bars" id="throughputBars">
          <span style="height: 12%;"></span>
          <span style="height: 12%;"></span>
          <span style="height: 12%;"></span>
          <span style="height: 12%;"></span>
          <span style="height: 12%;"></span>
          <span style="height: 12%;"></span>
          <span style="height: 12%;"></span>
          <span style="height: 12%;"></span>
          <span style="height: 12%;"></span>
          <span style="height: 12%;"></span>
          <span style="height: 12%;"></span>
          <span style="height: 12%;"></span>
        </div>
      </div>
      <div class="spark-scale mono">
        <span>-11h</span>
        <span>-8h</span>
        <span>-5h</span>
        <span>-2h</span>
        <span>Now</span>
      </div>
    </article>

    <article class="panel monitor-panel">
      <div class="panel-head">
        <div class="panel-title">Alerts</div>
        <div class="panel-meta">Realtime</div>
      </div>
      <ul class="alert-list" id="alertsList">
        <li class="alert-item ok">
          <div class="alert-main">
            <strong>Loading</strong>
            <p>Collecting latest bot and exchange state.</p>
          </div>
          <span class="mono">now</span>
        </li>
      </ul>
    </article>
  </section>

  <section class="panel-grid lower">
    <article class="panel monitor-panel">
      <div class="panel-head">
        <div class="panel-title">Open Positions</div>
        <div class="panel-meta" id="positionsMeta">0 / 0</div>
      </div>
      <div class="table-wrap">
        <table class="position-table">
          <thead>
            <tr>
              <th>Symbol</th>
              <th>Qty</th>
              <th>Avg</th>
              <th>Now</th>
              <th>PnL</th>
            </tr>
          </thead>
          <tbody id="positionsBody">
            <tr>
              <td class="mono" colspan="5">No position data.</td>
            </tr>
          </tbody>
        </table>
      </div>
    </article>

    <article class="panel monitor-panel">
      <div class="panel-head">
        <div class="panel-title">Risk Control</div>
        <div class="panel-meta">Policy</div>
      </div>
      <div class="risk-list">
        <div class="risk-item">
          <div class="risk-row">
            <span>Capital Usage</span>
            <span class="mono" id="riskCapitalText">0.0% / 0.0%</span>
          </div>
          <div class="risk-track"><span id="riskCapitalBar" style="width: 0%;"></span></div>
        </div>
        <div class="risk-item">
          <div class="risk-row">
            <span>Daily Loss</span>
            <span class="mono" id="riskDailyLossText">0.0% / 0.0%</span>
          </div>
          <div class="risk-track"><span id="riskDailyLossBar" style="width: 0%;"></span></div>
        </div>
        <div class="risk-item">
          <div class="risk-row">
            <span>Max Positions</span>
            <span class="mono" id="riskPositionText">0 / 0</span>
          </div>
          <div class="risk-track"><span id="riskPositionBar" style="width: 0%;"></span></div>
        </div>
      </div>
      <button class="btn btn-block" id="settingsBtn">리스크 설정 열기</button>
    </article>
  </section>
</section>
<script src="/static/dashboard.js"></script>
{% endblock %}
